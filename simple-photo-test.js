// GENERATED BY GEMINI
const path = require('path');
const { ConfigLoader } = require('./deal-aggregator/core/utils/config');
const { FacebookAPI } = require('./deal-aggregator/core/utils/facebook-api');

async function simplePhotoTest() {
  console.log('ğŸ“¸ SIMPLE FACEBOOK PHOTO TEST');
  console.log('=============================\n');

  try {
    const env = ConfigLoader.loadEnvironment();
    console.log(`ğŸ“Š Page: US Daily Tech Deals (${env.FB_PAGE_ID})`);
    console.log(`ğŸ–¼ï¸  Photo: media/sample.jpg\n`);

    const facebookAPI = new FacebookAPI(env.FB_PAGE_ID, env.FB_PAGE_ACCESS_TOKEN);
    
    const photoPath = path.join(__dirname, 'media/sample.jpg');
    const caption = `ğŸ“¸ Photo Test from Node.js - ${new Date().toISOString()}\n\nâœ… Success! Facebook media posting is working correctly.\n\nğŸš€ Posted via Graph API v19.0`;

    console.log('ğŸš€ Posting photo...');
    const result = await facebookAPI.postPhoto({ photoPath, caption });

    if (result.success) {
      console.log('\nâœ… PHOTO POSTED SUCCESSFULLY!');
      console.log(`ğŸ“ Photo ID: ${result.postId || result.id}`);
      console.log(`ğŸ“ Post ID: ${result.post_id}`);
      
      const postUrl = `https://www.facebook.com/${result.post_id}`;
      const pageUrl = `https://www.facebook.com/${env.FB_PAGE_ID}`;
      
      console.log(`ğŸ”— Direct Post: ${postUrl}`);
      console.log(`ğŸ  Page: ${pageUrl}`);
      console.log('\nğŸ‰ Check your Facebook page to confirm!');
      
    } else {
      console.log('\nâŒ FAILED TO POST');
      console.log(`Error: ${result.message}`);
      if (result.error) {
        console.log('Details:', JSON.stringify(result.error, null, 2));
      }
    }

  } catch (error) {
    console.log(`âŒ Error: ${error.message}`);
  }
}

simplePhotoTest().catch(console.error);